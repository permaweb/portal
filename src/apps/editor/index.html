<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
		<link rel="icon" href="favicon.svg" />
		<link rel="manifest" href="manifest.json" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Ramaraja&display=swap"
			rel="stylesheet"
		/>
		<link
			href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,200..900;1,200..900&family=Lora:ital,wght@0,400..700;1,400..700&family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Ramaraja&display=swap"
			rel="stylesheet"
		/>
		<title>Portal</title>
	</head>
	<body>
		<div id="root"></div>
		<div id="app-loader">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256">
				<path
					d="M84.27,171.73l-55.09-20.3a7.92,7.92,0,0,1,0-14.86l55.09-20.3,20.3-55.09a7.92,7.92,0,0,1,14.86,0l20.3,55.09,55.09,20.3a7.92,7.92,0,0,1,0,14.86l-55.09,20.3-20.3,55.09a7.92,7.92,0,0,1-14.86,0Z"
					fill="none"
					stroke="currentColor"
					stroke-linecap="round"
					stroke-linejoin="round"
					stroke-width="24"
				/>
				<line
					x1="176"
					y1="16"
					x2="176"
					y2="64"
					fill="none"
					stroke="currentColor"
					stroke-linecap="round"
					stroke-linejoin="round"
					stroke-width="24"
				/>
				<line
					x1="224"
					y1="72"
					x2="224"
					y2="104"
					fill="none"
					stroke="currentColor"
					stroke-linecap="round"
					stroke-linejoin="round"
					stroke-width="24"
				/>
				<line
					x1="152"
					y1="40"
					x2="200"
					y2="40"
					fill="none"
					stroke="currentColor"
					stroke-linecap="round"
					stroke-linejoin="round"
					stroke-width="24"
				/>
				<line
					x1="208"
					y1="88"
					x2="240"
					y2="88"
					fill="none"
					stroke="currentColor"
					stroke-linecap="round"
					stroke-linejoin="round"
					stroke-width="24"
				/>
			</svg>
		</div>
		<style>
			#app-loader {
				position: fixed;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				z-index: 9999;
			}

			#app-loader svg {
				width: 50px;
				height: 50px;
				animation: open 150ms cubic-bezier(0, 0, 0.2, 1) 0ms;
			}

			@keyframes open {
				0% {
					opacity: 0;
				}
				100% {
					opacity: 1;
				}
			}
		</style>
		<script>
			const themeBackgrounds = {
				'light-primary': '#FFFFFF',
				'light-high-contrast': '#FEFEFE',
				'light-alt-1': '#FEFEFE',
				'light-alt-2': '#FCFCFC',
				'dark-primary': '#1B1B1B',
				'dark-high-contrast': '#191A1E',
				'dark-alt-1': '#16161C',
				'dark-alt-2': '#17191F',
			};

			function getTheme() {
				try {
					const settings = localStorage.getItem('settings');
					if (settings) {
						const parsed = JSON.parse(settings);
						return parsed.theme;
					}
				} catch (e) {}

				return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
					? 'dark-primary'
					: 'light-primary';
			}

			const theme = getTheme();
			const backgroundColor = themeBackgrounds[theme] || themeBackgrounds['dark-primary'];
			document.body.style.backgroundColor = backgroundColor;

			const isDarkTheme = theme.startsWith('dark');
			const iconColor = isDarkTheme ? '#EBEBEB' : '#444444';
			const loaderIcon = document.querySelector('#app-loader svg');

			if (loaderIcon) {
				loaderIcon.style.color = iconColor;
			}

			window.hideAppLoader = function () {
				const loader = document.getElementById('app-loader');
				if (loader) {
					loader.style.display = 'none';
				}
			};
		</script>
		<script>
			if ('serviceWorker' in navigator) {
				/* Only register service worker in production builds */
				/* Skip service worker for domain fetch to detect ArNS updates */
				const isProduction = window.location.protocol === 'https:' || window.location.hostname !== 'localhost';
				const skipForArNS = window.location.hostname.includes('portal');

				if (isProduction && !skipForArNS) {
					navigator.serviceWorker
						.register('/sw.js', { scope: '/' })
						.then((registration) => {
							console.log('SW registered: ', registration);
						})
						.catch((registrationError) => {
							console.log('SW registration failed: ', registrationError);
						});
				}
			}
		</script>
		<script type="module" src="index.tsx"></script>
	</body>
</html>
